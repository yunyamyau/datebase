<h1 name="content" align="center"><a href=""><img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/></a> MSSQL</h1>

<p align="center">
  <a href="#lab1"><img alt="lab1" src="https://img.shields.io/badge/Lab1-6B8E23"></a> 
  <a href="#lab2"><img alt="lab2" src="https://img.shields.io/badge/Lab2-6B8E23"></a> 
  <a href="#lab3"><img alt="lab3" src="https://img.shields.io/badge/Lab3-6B8E23"></a> 
</p>

<a id="lab1"></a>
# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабараторная №1
[Назад](#content)
<h3 align="center">
  <a href="#client"></a>
  Автоматизация распределения учебной нагрузки. Вариант 18.
</h3>

Разработать ER-модель данной предметной области: выделить сущности, их атрибуты, связи между сущностями. 
Для каждой сущности указать ее имя, атрибут (или набор атрибутов), являющийся первичным ключом, список остальных атрибутов.
Для каждого атрибута указать его тип, ограничения, может ли он быть пустым, является ли он первичным ключом.
Для каждой связи между сущностями указать: 
- тип связи (1:1, 1:M, M:N)
- обязательность
ER-модель д.б. представлена в виде ER-диаграммы (картинка)
По имеющейся ER-модели создать реляционную модель данных и отобразить ее в виде списка сущностей с их атрибутами и типами атрибутов,  для атрибутов указать, явл. ли он первичным или внешним ключом

Информация о преподавателях: ФИО, список дисциплин, которые он может вести, обязательное кол-во часов нагрузки (отдельно лекции и практика).
Учебный план (составляется на текущий учебный год): дисциплина, специальность, курс, семестр, кол-во часов (отдельно лекции и практика), вид отчетности (зачет, экзамен), преподаватель.
Реализовать:
- Вывод нагрузки конкретного преподавателя;
- Вывод учебной нагрузки для специальности (дисциплина, кол-во часов, вид (лекция /практика), преподаватель).
- Подчсет кол-ва часов нагрузки преподавателя, поиск самого «загруженного преподавателя»
- Вывод списка экзаменов и зачетов в ближайшую сессию для специальности на конкретном курсе

#### ER модель:
![ER модель](/pic/ER.png)


#### Реляционная модель:
![REL модель](/pic/REL.png)



<a id="lab2"></a>
# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабараторная №2
[Назад](#content)


В соответствии с реляционной моделью данных, разработанной в Лаб.№1, создать реляционную БД на учебном сервере БД :
- создать таблицы, определить первичные ключи и иные ограничения
- определить связи между таблицами
- создать диаграмму
- заполнить все таблицы адекватной информацией (не меньше 10 записей в таблицах, наличие примеров для связей типа 1:M )


```
CREATE TABLE Дисциплина (
    ID INT PRIMARY KEY IDENTITY,
    Название NVARCHAR(50) NOT NULL
);

CREATE TABLE Специальность (
    ID INT PRIMARY KEY IDENTITY,
    Название NVARCHAR(50) NOT NULL
);

CREATE TABLE Тип_занятия (
    ID INT PRIMARY KEY IDENTITY,
    Название NVARCHAR(8) NOT NULL CHECK (Название IN ('Лекция','Практика'))
);

CREATE TABLE Тип_отчётности (
    ID INT PRIMARY KEY IDENTITY,
    Название NVARCHAR(7) NOT NULL CHECK (Название IN ('Зачёт','Экзамен'))
);

CREATE TABLE Преподаватель (
    ID INT PRIMARY KEY IDENTITY,
    ФИО NVARCHAR(150) NOT NULL,
    [Обязательные часы(лекции)] TINYINT NOT NULL,
    [Обязательные часы(практика)] TINYINT NOT NULL
);

CREATE TABLE Учебный_план (
    ID INT PRIMARY KEY IDENTITY,
    Курс TINYINT NOT NULL,
    Семестр TINYINT NOT NULL CHECK (Семестр IN (1,2)),
    [Учебный год] NVARCHAR(9) NOT NULL,
    [Часы лекций] TINYINT NOT NULL,
    [Часы практик] TINYINT NOT NULL,
    Специальность_ID INT NOT NULL FOREIGN KEY REFERENCES Специальность(ID),
    Дисциплина_ID INT NOT NULL FOREIGN KEY REFERENCES Дисциплина(ID),
    Тип_отчётности_ID INT NOT NULL FOREIGN KEY REFERENCES Тип_отчётности(ID)
);

CREATE TABLE Нагрузка (
    ID INT PRIMARY KEY IDENTITY,
    [Назначенные часы] TINYINT NOT NULL,
    Учебный_план_ID INT NOT NULL FOREIGN KEY REFERENCES Учебный_план(ID),
    Преподаватель_ID INT NOT NULL FOREIGN KEY REFERENCES Преподаватель(ID),
    Тип_занятия_ID INT NOT NULL FOREIGN KEY REFERENCES Тип_занятия(ID)
);

CREATE TABLE Дисциплина_Специальность (
    Дисциплина_ID INT NOT NULL FOREIGN KEY REFERENCES Дисциплина(ID),
    Специальность_ID INT NOT NULL FOREIGN KEY REFERENCES Специальность(ID),
    PRIMARY KEY (Дисциплина_ID, Специальность_ID)
);

CREATE TABLE Преподаватель_Дисциплина (
    Преподаватель_ID INT NOT NULL FOREIGN KEY REFERENCES Преподаватель(ID),
    Дисциплина_ID INT NOT NULL FOREIGN KEY REFERENCES Дисциплина(ID),
    PRIMARY KEY (Преподаватель_ID, Дисциплина_ID)
);
```

#### Диаграмма:
![Диаграмма](/pic/диаграмма.png)

#### Заполнение таблиц:
```
INSERT INTO Дисциплина (Название) VALUES
('Математический анализ'),
('Теория вероятности'), 
('История'),
('Основы Российской государственности'),
('Языки машинного программирования'),
('Основы информатики'),
('Комплексный анализ'),
('Физкультура'),
('Дифференциальные уравнения'),
('Физика');
```
![Дисциплина](/pic/Дисциплина.png)
```
INSERT INTO Специальность (Название) VALUES
('Прикладная математика и информатика'),
('Математика и компьютерные науки'),
('Фундаментальная математика и механика'),
('Прикладная математика и физика'),
('Бизнес-информатика'),
('Программная инженерия'),
('Математическое обеспечение'),
('Информатика и вычислительная техника'),
('Статистика и анализ данных'),
('Информационная безопасность');
```
![Специальность](/pic/Специальность.png)
```
INSERT INTO Преподаватель (ФИО, [Обязательные часы(лекции)], [Обязательные часы(практика)]) VALUES
('Иванов Александр Сергеевич', 120, 80),
('Петрова Мария Владимировна', 100, 100),
('Сидоров Дмитрий Иванович', 150, 60),
('Козлова Елена Петровна', 80, 120),
('Никитин Алексей Викторович', 130, 70),
('Фёдорова Ольга Дмитриевна', 90, 110),
('Громов Павел Сергеевич', 140, 50),
('Смирнова Анна Михайловна', 110, 90),
('Васильев Игорь Николаевич', 95, 105),
('Зайцева Татьяна Викторовна', 125, 75);
```
![Преподаватель](/pic/Преподаватель.png)
```
INSERT INTO Преподаватель_Дисциплина (Преподаватель_ID, Дисциплина_ID) VALUES
(1,1), (1,2), (1,7), (1,9),  
(2,5), (2,6), (2,8),
(3,10), (3,1),
(4,3), (4,4), 
(5,2), (5,9), (5,10),
(6,5), (6,6), (6,8),
(7,1), (7,7), (7,9),
(8,3), (8,4), (8,8),
(9,5), (9,6), (9,10),
(10,2), (10,7), (10,9);
```
![Преподаватель Дисциплина](/pic/Преподаватель%20дисциплина.png)
```
INSERT INTO Дисциплина_Специальность (Дисциплина_ID, Специальность_ID) VALUES
(1,1), (2,1), (5,1), (6,1), (7,1), (9,1), (10,1), 
(1,2), (2,2), (5,2), (6,2), (7,2), (9,2),
(1,3), (2,3), (7,3), (9,3), (10,3),
(1,4), (2,4), (7,4), (9,4), (10,4),
(2,5), (5,5), (6,5), (8,5),
(1,6), (2,6), (5,6), (6,6), (9,6),
(1,7), (2,7), (5,7), (6,7), (9,7),
(1,8), (2,8), (5,8), (6,8), (10,8),
(1,9), (2,9), (5,9), (6,9),
(1,10), (2,10), (5,10), (6,10), (9,10),
(3,1), (3,2), (3,3), (3,4), (3,5), (3,6), (3,7), (3,8), (3,9), (3,10),
(4,1), (4,2), (4,3), (4,4), (4,5), (4,6), (4,7), (4,8), (4,9), (4,10),
(8,1), (8,2), (8,3), (8,4), (8,6), (8,7), (8,8), (8,9), (8,10);
```
![Дисциплина Специальность](/pic/Дисциплина%20специальность.png)
```
INSERT INTO Учебный_план (Курс, Семестр, [Учебный год], [Часы лекций], [Часы практик], Специальность_ID, Дисциплина_ID, Тип_отчётности_ID) VALUES
(1, 1, '2023-2024', 60, 40, 1, 1, 2), 
(1, 1, '2023-2024', 50, 30, 1, 6, 2),
(1, 2, '2023-2024', 70, 35, 1, 2, 2),
(1, 1, '2023-2024', 40, 20, 2, 1, 2),
(1, 2, '2023-2024', 55, 25, 2, 5, 2),
(1, 1, '2023-2024', 65, 30, 3, 1, 2),
(1, 2, '2023-2024', 60, 30, 3, 10, 2),
(1, 1, '2023-2024', 45, 15, 4, 3, 1),
(1, 1, '2023-2024', 30, 30, 4, 8, 1), 
(1, 2, '2023-2024', 35, 15, 5, 4, 1);

INSERT INTO Тип_отчётности (Название) VALUES ('Зачёт'), ('Экзамен');
```
![Учебный план](/pic/Учебный%20план.png)
```
INSERT INTO Нагрузка ([Назначенные часы], Учебный_план_ID, Преподаватель_ID, Тип_занятия_ID) VALUES
(60, 1, 1, 1), (40, 1, 1, 2),
(50, 2, 2, 1), (30, 2, 2, 2),
(70, 3, 3, 1), (35, 3, 3, 2),
(55, 5, 5, 1), (25, 5, 5, 2),
(60, 7, 7, 1), (30, 7, 7, 2),
(45, 8, 4, 1), (15, 8, 4, 2),
(30, 9, 6, 1), (30, 9, 6, 2),
(35, 10, 8, 1), (15, 10, 8, 2);

INSERT INTO Тип_занятия (Название) VALUES ('Лекция'), ('Практика');
```
![Нагрузка](/pic/Нагрузка.png)



<a id="lab3"></a>
# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабараторная №3
[Назад](#content)

Часть 1

<mark style="background-color: #ffd6e7; padding: 4px 8px; border-radius: 4px;">
**Цель:** изучить конструкции языка SQL для манипулирования данными в СУБД MSSQL.
</mark>

<div style="background-color: #ffebee; border: 1px solid #f8bbd0; padding: 10px 15px; border-radius: 6px; margin: 10px 0;">
🎯 <strong>Цель:</strong> изучить конструкции языка SQL для манипулирования данными в СУБД MSSQL.
</div>

<div style="background-color: #ff69b4; color: white; padding: 10px 15px; border-radius: 5px; margin: 10px 0;">
<strong>Цель:</strong> изучить конструкции языка SQL для манипулирования данными в СУБД MSSQL.
</div>


Задания и краткое описание работы:
1. Выборка из одной таблицы.
1.1 Выбрать из произвольной таблицы данные и отсортировать их по двум  произвольным имеющимся в таблице признакам (разные направления сортировки).
1.2 Выбрать из произвольной таблицы те записи, которые удовлетворяют
условию отбора (where). Привести 2-3 запроса.
1.3 Привести примеры 2-3 запросов с использованием агрегатных функций
(count, max, sum и др.) с группировкой и без группировки. 
1.4  Привести примеры подведения подытога с использованием GROUP BY [ALL] [ CUBE | ROLLUP](2-3 запроса). В ROLLUP и CUBE использовать не менее 2-х столбцов.
1.5 Выбрать из таблиц информацию об объектах, в названиях которых нет заданной последовательности букв (LIKE).

2. Выборка из нескольких таблиц.
2.1 Вывести информацию подчиненной (дочерней) таблицы, заменяя коды
(значения внешних ключей) соответствующими символьными значениями из
родительских таблиц. Привести 2-3 запроса с использованием классического
подхода соединения таблиц (where).
2.2. Реализовать запросы пункта 2.1 через внутреннее соединение inner join. 
2.3. Левое внешнее соединение left join. Привести 2-3 запроса.
2.4. Правое внешнее соединение right join. Привести 2-3 запроса 
2.5. Привести примеры 2-3 запросов с использованием агрегатных функций
и группировки.
2.6. Привести примеры 2-3 запросов с использованием группировки и условия отбора групп (Having).
2.7. Привести примеры 3-4 вложенных (соотнесенных, c использованием IN, EXISTS) запросов.
3. Представления
3.1  На основе любых запросов из п. 2 создать два представления (VIEW).
3.2  Привести примеры использования общетабличных выражений (СТЕ) (2-3 запроса)
4. Функции ранжирования
4.1 Привести примеры 3-4 запросов с использованием ROW_NUMBER, RANK, DENSE_RANK (c  PARTITION BY и без)
5. Объдинение, пересечение, разность
5.1 Привести примеры 3-4 запросов с использованием UNION / UNION ALL, EXCEPT, INTERSECT. Данные  в одном из запросов отсортируйте по произвольному признаку.
6. Использование CASE, PIVOT и UNPIVOT.
6.1 Привести примеры получения сводных (итоговых) таблиц с использованием CASE
6.2 Привести примеры получения сводных (итоговых) таблиц с использованием PIVOT и UNPIVOT.

Обязательными к выполнению являются запросы, приведенные ниже (смотри свой вариант).
Отчет  по лабораторной работе предоставляется в виде  документа (Фамилия_Группа.docx). 
В этом  документе по каждому заданию необходимо представить: условие запроса, текст SQL-запроса, скрин-копию результата выполнения запроса.
Часть 2
Составить следующие запросы:
a)  Для каждой дисциплины вывести преподавателей, которые могут ее вести
b)  Найти преподавателей с максимальной нагрузкой или по лекциям, или по практике
c)  Для каждой дисциплины и каждой специальности вывести количество лет, в течение которых
эта дисциплина на этой специальности читается
d)  Для каждого преподавателя выдать дисциплины (лекции и практику отдельно) из учебного плана, которые он мог бы вести
e)  Найти дисциплины, по которым есть лекции, но нет практики для одного и того же курса и специальности


